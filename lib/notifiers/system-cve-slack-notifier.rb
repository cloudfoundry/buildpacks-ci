# encoding: utf-8
require_relative '../slack-client'

class SystemCVESlackNotifier
  def self.notify!(cves, related_to_stacks)
    return unless related_to_stacks
    slack_output = "There are *#{cves.length}* new CVEs:\n"

    cves.each do |cve|
      slack_output << "- #{cve[:title]}*\n"
    end

    slack_client = SlackClient.new(
      ENV['SLACK_WEBHOOK'],
      ENV['SLACK_CHANNEL'],
      'dependency-notifier'
    )
    slack_client.post_to_slack slack_output
  end
end
