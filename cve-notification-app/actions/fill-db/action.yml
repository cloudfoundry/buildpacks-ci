name: 'Fill Database with CVEs'
description: |
  Fills the Database with all the Known CVEs

inputs:
  db-uri:
    description: Database URI
    required: true
  nvd-nist-api-key:
    description: NVD Nist API Key
    required: true


runs:
  using: 'composite'
  steps:
    - id: fill-db
      shell: bash
      run: |
        #!/usr/bin/env bash
        set -euo pipefail

        cd "${{ github.action_path }}/entrypoint"

        go build -o ./entrypoint

        ./entrypoint \
          --db-uri "${{ inputs.db-uri }}" \
          --dep-list "${{ github.workspace }}/cve-notification-app/dependencies.csv" \
          --nvd-nist-api-key "${{ inputs.nvd-nist-api-key }}"

        rm -f ./entrypoint